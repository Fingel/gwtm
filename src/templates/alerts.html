{% extends "base.html" %}

{% block content %}
<div style="padding-left:16px">
  <h2>Gravitational Wave Ligo Alerts</h2>
  <p></p>
  <form action="" method="post">
    {{ form.graceids.label }} {{ form.graceids }}
    <p>{{ form.submit() }}</p>
  </form>
  {% if viz %}
      <h3>Gravitational Wave Localization and Pointings: {{ graceid }}</h3>
      <body>
        <link rel="stylesheet" href="http://aladin.u-strasbg.fr/AladinLite/api/v2/latest/aladin.min.css" />
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js" charset="utf-8"></script>
        <div id="aladin-lite-div" style="width:900px;height:500px;"></div>
        <script type="text/javascript" src="http://aladin.u-strasbg.fr/AladinLite/api/v2/latest/aladin.min.js" charset="utf-8"></script>
        
        <!-- Creation of Aladin Lite instance with initial parameters -->
        <script type="text/javascript">
            var aladin = A.aladin('#aladin-lite-div', {survey: "P/DSS2/color", fov:180, target: "90 -30"});
            $('input[name=survey]').change(function() {
            aladin.setImageSurvey($(this).val());});

            var overlays = JSON.parse('{{ overlays | tojson }}');
            for (i = 0; i < overlays.length; i++) {
              var contour = A.graphicOverlay({color:overlays[i].color, lineWidth: 2, name:overlays[i].name});
              aladin.addOverlay(contour);
              var overlay_contours = overlays[i].contours
              for (j = 0; j < overlay_contours.length; j++){
                contour.addFootprints([A.polygon(overlay_contours[j].polygon)])
              }
            }
        </script>
      </body>
  {% endif %}
</div>

{% endblock %}
